-- Criação do banco de dados
DROP DATABASE IF EXISTS findspot;
CREATE DATABASE findspot;
USE findspot;

-- Tabela: usuarios
CREATE TABLE usuarios (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nome VARCHAR(100) NOT NULL,
    email VARCHAR(100) NOT NULL UNIQUE,
    CPF VARCHAR(14) NOT NULL,
    telefone VARCHAR(20) NOT NULL,
    senha VARCHAR(255) NOT NULL,
    criado_em TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    is_admin TINYINT(1) DEFAULT 0
);

-- Tabela: vagas
CREATE TABLE vagas (
    id INT AUTO_INCREMENT PRIMARY KEY,
    identificador VARCHAR(10),
    descricao TEXT,
    status ENUM('livre', 'ocupada', 'reservada') DEFAULT 'livre'
);

-- Tabela: reservas
CREATE TABLE reservas (
    id INT AUTO_INCREMENT PRIMARY KEY,
    usuario_id INT,
    vaga_id INT,
    data DATE,
    horario_inicio TIME,
    horario_fim TIME,
    status ENUM('pendente', 'confirmada', 'cancelada', 'encerrada') DEFAULT 'pendente',
    criado_em TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    data_confirmacao DATE,
    hora_confirmacao TIME,
    data_saida DATE,
    hora_saida TIME,
    FOREIGN KEY (usuario_id) REFERENCES usuarios(id),
    FOREIGN KEY (vaga_id) REFERENCES vagas(id)
);

-- Tabela: faturas
CREATE TABLE faturas (
    id INT AUTO_INCREMENT PRIMARY KEY,
    reserva_id INT,
    valor DECIMAL(10,2),
    status ENUM('pendente','pago') DEFAULT 'pendente',
    data_geracao DATETIME,
    FOREIGN KEY (reserva_id) REFERENCES reservas(id)
);

-- Usuário admin padrão
INSERT INTO usuarios (nome, email, CPF, telefone, senha, is_admin)
VALUES (
    'Administrador',
    'admin@findspot.com',
    '000.000.000-00',
    '(00) 00000-0000',
    '$2b$12$Dpw4kr1LJntBAMTiIil2b.dXjk6i21ZCwafluhYmzrzms/rFoNvhi',
    1
);
